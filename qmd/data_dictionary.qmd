---
title: "Data Dictionary and Lineage Report"
subtitle: "Pennsylvania USTIF Auction Analysis"
author: "Kaleb K. Javier"
date: last-modified
date-format: "MMMM D, YYYY"
format:
  pdf:
    toc: true
    toc-depth: 3
    number-sections: true
    colorlinks: true
    link-citations: true
    fontsize: 10pt
    geometry:
      - top=0.9in
      - bottom=0.9in
      - left=0.9in
      - right=0.9in
    include-in-header:
      text: |
        \usepackage{longtable}
        \usepackage{booktabs}
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    theme: cosmo
    code-fold: true
---

{{< pagebreak >}}

# Executive Summary

This document provides comprehensive metadata for the Pennsylvania Underground Storage Tank Indemnification Fund (USTIF) auction analysis project. It encompasses:
**3 proprietary USTIF datasets** (actuarial claims, contracts, tank construction); **9 eFACTS scraped tables** (facility metadata, inspections, violations, permits, remediation); **6 PASDA/eMapPA geospatial layers** (active/inactive tanks, cleanup sites); **1 master linkage table** (38,545 registered facilities).

All variable definitions are cross-referenced against official Pennsylvania Department of Environmental Protection (PA DEP) and Insurance Department documentation.

# Source Data Inventory

This section catalogs each upstream data source, distinguishing between proprietary USTIF actuarial data, public PA DEP compliance data, and derived analytical datasets.

## USTIF Actuarial Data (Proprietary)

::: {.callout-note title="Official Source Metadata: Pennsylvania USTIF"}
- **Publisher:** Pennsylvania Insurance Department, Underground Storage Tank Indemnification Fund
- **Official Documentation:** <https://ustif.pa.gov/>
- **Regulatory Authority:** 25 Pa. Code Chapter 977 (<https://www.pacodeandbulletin.gov/Display/pacode?file=/secure/pacode/data/025/chapter977/chap977toc.html>)
- **Coverage Limits:** Up to $1,500,000 per claim; $5,000 deductible per cleanup
- **Update Frequency:** Actuarial data provided periodically for research purposes (not public)
- **Contact:** 717-787-0763 | ra-ustif@pa.gov
:::

### Individual Claims Data

**Local File:** `Actuarial_UST_Individual_Claim_Data_thru_63020_4.xlsx`

**Processed Output:** `claims_clean.csv` (7,793 records)

**Description:** Individual claim-level records from USTIF's claims management system, containing loss amounts, dates, and geographic identifiers.

| Variable | Type | Description | Lineage |
|----------|------|-------------|---------|
| `department` | String | Facility permit number (format: `XX-XXXXX`) | Direct from `event_department_abbreviation`; cleaned via `janitor::clean_names()` |
| `claim_number` | String | Unique claim identifier | Direct; deduplicated in ETL |
| `paid_loss` | Numeric | Indemnity payments to claimant for corrective action costs | Direct; per 25 Pa. Code §977.3, "reasonable and necessary expenses for corrective action" |
| `paid_alae` | Numeric | Allocated Loss Adjustment Expenses; claim-specific costs (legal fees, expert fees, investigators) | Direct; per IRMI definition: "fees paid to outside attorneys, experts, and investigators used to defend claims" |
| `incurred_loss` | Numeric | Paid loss plus outstanding case reserves | Direct; represents ultimate expected cost |
| `loss_reported_date` | Date | Date loss (release) was reported to USTIF | `as.Date(date_of_loss_reported)` |
| `claim_date` | Date | Date claim was filed with USTIF | `as.Date(date_of_claim)` |
| `claim_status` | String | Current claim status (e.g., "Closed Eligible", "Open") | Direct |
| `closed_date` | Date | Date claim was closed | `as.Date(date_closed)` |
| `dep_region` | String | PA DEP regional office jurisdiction | Direct; 6 regions: Southeast, Northeast, Southcentral, Northcentral, Southwest, Northwest |
| `claimant_name` | String | Name of tank owner/operator filing claim | Direct from `claimant_full_name` |
| `county` | String | County of facility location | `str_to_title(str_trim(county))` |
| `location_desc` | String | Location classification | Direct (e.g., "Private", "Local Government") |
| `products` | String | Petroleum product(s) stored | Direct (e.g., "Unleaded Gasoline", "Diesel") |
| `product_other` | String | Additional product description | Direct |
| `claim_year` | Integer | Year claim was filed | `year(claim_date)` |
| `loss_year` | Integer | Year loss was reported | `year(loss_reported_date)` |
| `closed_year` | Integer | Year claim was closed | `year(closed_date)` |
| `total_paid` | Numeric | Sum of `paid_loss` + `paid_alae` | `coalesce(paid_loss, 0) + coalesce(paid_alae, 0)` |
| `is_closed` | Boolean | Whether claim is closed | `!is.na(closed_date) \| str_detect(claim_status, "closed")` |
| `is_open` | Boolean | Whether claim is open | `str_detect(claim_status, "open")` |
| `claim_duration_days` | Numeric | Days from claim to closure | `difftime(closed_date, claim_date, units = "days")` |
| `claim_duration_years` | Numeric | Years from claim to closure | `claim_duration_days / 365.25` |

### Contract Data

**Local File:** `Actuarial_Contract_Data_2.xlsx`

**Processed Output:** `contracts_clean.csv` (658 records)

**Description:** Auction and contract records for USTIF-procured remediation work, including bid types and payment amounts.

| Variable | Type | Description | Lineage |
|----------|------|-------------|---------|
| `claim_number` | String | Foreign key to claims table | Direct from `contract_jobs_claim_number` |
| `contract_id` | String | Unique contract identifier | Direct from `contract_job_identifier` |
| `adjuster` | String | TPA adjuster assigned to claim | Direct from `adjuster_full_name` |
| `site_name` | String | Facility/site name | Direct from `cts_site_name` |
| `department` | String | Facility permit number | Direct from `department_name` |
| `brings_to_closure` | String | Whether contract brings site to closure | Direct from `contract_will_bring_site_to_closure_desc` |
| `consultant` | String | Remediation consultant firm | Direct from `consultant_full_name` |
| `contract_start` | Date | Contract effective date | `as.Date(contract_effective_date)` |
| `contract_end` | Date | Contract end date | `as.Date(contract_end_date)` |
| `contract_category` | String | Contract category | Direct from `contract_category_desc` |
| `bid_approval_date` | Date | Date bid was approved | `as.Date(bid_approval_letter_to_claimant)` |
| `bid_type` | String | Type of bid (Scope of Work, Bid-to-Result) | Direct from `bid_type_desc` |
| `contract_type` | String | Contract type classification | Direct from `contract_type_desc` |
| `base_price` | Numeric | Initial contract price | Direct from `contract_base_price` |
| `amendments_total` | Numeric | Sum of contract amendments | Direct from `total_price_of_amendments` |
| `paid_to_date` | Numeric | Amount paid to contractor | Direct from `amount_paid_to_date` |
| `contract_year` | Integer | Year contract started | `year(contract_start)` |
| `total_contract_value` | Numeric | Base + amendments | `coalesce(base_price, 0) + coalesce(amendments_total, 0)` |
| `is_bid_to_result` | Boolean | Bid-to-Result auction flag | `str_detect(bid_type, "bid\|result")` |
| `is_scope_of_work` | Boolean | Scope of Work auction flag | `str_detect(bid_type, "scope\|sow")` |
| `auction_type` | String | Categorical auction type | Derived: "Scope of Work", "Bid-to-Result", "Other/Unknown" |
| `brings_to_closure_flag` | Boolean | Closure indicator | `str_detect(brings_to_closure, "yes\|true\|closure")` |

### Tank Construction Data

**Local File:** `Tank_Construction_Closed.xlsx`

**Processed Output:** `tanks_clean.csv` (6,914 records)

**Status:** DEPRECATED — Superseded by PA DEP `facility_linkage_table.csv` for facility characteristics. Retained for historical tank construction attributes only.

| Variable | Type | Description | Lineage |
|----------|------|-------------|---------|
| `facility_id` | String | Permit number (format: `XX-XXXXX`) | Direct from `pf_other_id` |
| `facility_name` | String | Facility name | Direct |
| `client_id` | Integer | Client identifier | Direct |
| `region` | Integer | DEP region code (1-6) | Direct from `region_code` |
| `tank_type` | String | AST/UST indicator | Direct from `ast_ust` |
| `tank_seq` | Integer | Tank sequence number | Direct from `seq_number` |
| `capacity_gallons` | Integer | Tank capacity in gallons | Direct from `capacity` |
| `install_date` | Date | Tank installation date | `as.Date(date_installed)` |
| `substance` | String | Substance stored | Direct from `substance_stored_desc` |
| `construction_desc` | String | Tank construction type | Direct from `comp_desc` |
| `tank_status` | String | Tank status code | Direct from `tank_status_code` |
| `tank_age_years` | Numeric | Tank age as of processing | `(Sys.Date() - install_date) / 365.25` |
| `is_single_wall` | Boolean | Single-wall construction | `str_detect(construction_desc, "single\|bare")` |
| `is_double_wall` | Boolean | Double-wall construction | `str_detect(construction_desc, "double\|secondary")` |
| `is_fiberglass` | Boolean | Fiberglass construction | `str_detect(construction_desc, "fiberglass\|frp")` |
| `wall_type` | String | Categorical wall type | Derived: "Single-Wall", "Double-Wall", "Unknown/Other" |
| `is_underground` | Boolean | Underground flag | `tank_type == "UST"` |

## PA DEP eFACTS Data (Scraped)

::: {.callout-note title="Official Source Metadata: PA DEP eFACTS"}
- **Publisher:** Pennsylvania Department of Environmental Protection
- **Official System:** Environment, Facility, Application, Compliance Tracking System (eFACTS)
- **URL:** <https://www.ahs.dep.pa.gov/eFACTSWeb/default.aspx>
- **Documentation:** [Facility Inspection Violation Enforcement Report Instructions (PDF)](https://files.dep.state.pa.us/Water/BPNPSM/WastewaterReports/Facility_Inspection_Violation_Enforcement_Report_Instructions.pdf)
- **Update Frequency:** Real-time (web scraping captures point-in-time snapshot)
- **Field Codebook Source:** [PA DEP Storage Tank Data](https://www.pa.gov/agencies/dep/programs-and-services/land/storage-tanks/storage-tank-data)
- **Contact:** 800-42TANKS (PA only) | 717-772-5599
:::

The eFACTS system is PA DEP's central database for facility compliance, inspections, violations, permits, and remediation tracking. Data was acquired via web scraping (`R/etl/02b_efacts_scrape.R`).

### efacts_facility_meta

**Records:** 126 | **Batch Import:** 2026-01-02

| Variable | Type | Description | Official Definition |
|----------|------|-------------|---------------------|
| `efacts_facility_id` | Integer | Primary key; eFACTS internal facility ID | Per PA DEP: "SITE_ID (eFACTS facility identifier)" |
| `facility_id` | Integer | Redundant facility ID | Same as efacts_facility_id in most cases |
| `facility_name` | String | Registered facility name | — |
| `address` | String | Full facility address | Multi-line; includes municipality and county |
| `status` | String | Facility status | Per eFACTS: "Active" or "Inactive" |
| `program` | String | DEP program classification | e.g., "Environmental Cleanup & Brownfields", "Storage Tanks" |
| `batch_import_date` | Datetime | Scrape timestamp | ISO 8601 format |

### efacts_tanks

**Records:** 246 | **Description:** Sub-facility tank records from eFACTS

| Variable | Type | Description |
|----------|------|-------------|
| `efacts_facility_id` | Integer | FK to facility_meta |
| `tank_internal_id` | String | Generated internal ID |
| `sub_facility_name` | String | Tank/sub-facility name |
| `type` | String | Tank type classification |
| `other_id` | Integer | Alternative ID |
| `status` | String | Tank status |
| `e_map_pa_location` | String | eMapPA hyperlink |

### efacts_inspections

**Records:** ~200K (full scrape) | **Sample:** 100+ in test

| Variable | Type | Description | Official Definition |
|----------|------|-------------|---------------------|
| `efacts_facility_id` | Integer | FK to facility_meta | — |
| `inspection_id` | String | Unique inspection identifier | Extracted from "Type (ID)" format |
| `inspection_type_clean` | String | Inspection type name | Parsed; e.g., "Routine Inspection" |
| `inspection_type_raw` | String | Raw inspection type with ID | e.g., "Routine Inspection (123456)" |
| `inspection_date` | String | Date of inspection | MM/DD/YYYY format |
| `result` | String | Inspection result | e.g., "Compliant", "Violation Observed" |

### efacts_violations

**Records:** 1,272 | **Description:** Violation and enforcement records with full penalty data

| Variable | Type | Description | Official Definition |
|----------|------|-------------|---------------------|
| `efacts_facility_id` | Integer | FK to facility_meta | — |
| `inspection_id` | Integer | FK to inspections | — |
| `violation_id` | Integer | Unique violation ID | — |
| `violation_date` | String | Date violation occurred | — |
| `description` | String | Violation description | — |
| `resolution` | String | Resolution status | — |
| `citation` | String | PA Code citation | e.g., "25 Pa. Code §245.XXX" |
| `violation_type` | String | Type classification | — |
| `enforcement_id` | Float | Enforcement action ID | NULL if no action |
| `enf_type` | String | Enforcement type | e.g., "Civil Penalty", "Compliance Order" |
| `penalty_assessed` | Float | Penalty amount assessed | Per PA DEP reporting |
| `penalty_collected` | Float | Amount collected | — |
| `date_executed` | String | Enforcement execution date | — |
| `penalty_final_date` | String | Penalty finalization date | — |
| `total_amount_due` | Float | Outstanding balance | — |
| `taken_against` | String | Entity penalized | — |
| `on_appeal` | String | Appeal status | "Yes"/"No" |
| `penalty_status` | String | Current penalty status | — |
| `enforcement_status` | String | Enforcement status | — |
| `num_violations_addressed` | Float | Count of violations in enforcement | — |

### efacts_permits_detail

**Records:** 128 | **Description:** Authorization/permit details

| Variable | Type | Description |
|----------|------|-------------|
| `efacts_facility_id` | Integer | FK to facility_meta |
| `auth_id` | Integer | Authorization ID |
| `authorization_id` | Float | Secondary auth ID |
| `permit_number` | String | Permit number |
| `site` | String | Site name |
| `client` | String | Client name |
| `authorization_type` | String | Type (e.g., "Tank Installation") |
| `application_type` | String | Application classification |
| `authorization_is_for` | String | Authorization purpose |
| `date_received` | String | Application receipt date |
| `status` | String | Permit status |

### efacts_permits_tasks

**Records:** 252 | **Description:** Permit task milestones

| Variable | Type | Description |
|----------|------|-------------|
| `efacts_facility_id` | Integer | FK to facility_meta |
| `auth_id` | Integer | FK to permits_detail |
| `task_internal_id` | String | Generated task ID |
| `task` | String | Task description |
| `start_date` | String | Task start date |
| `target_date` | String | Target completion date |
| `completion_date` | String | Actual completion date |

### efacts_remediation_summary

**Records:** 66 | **Description:** Remediation incident summary (LRPACT records)

| Variable | Type | Description |
|----------|------|-------------|
| `efacts_facility_id` | Integer | FK to facility_meta |
| `lrpact_id` | String | Land Recycling Program Activity ID |
| `incident_name` | String | Incident name |
| `confirmed_release_date` | String | Date release confirmed |
| `type` | String | Incident type |
| `cleanup_status` | String | Current cleanup status |
| `cleanup_status_date` | String | Status date |

### efacts_remediation_substances

**Records:** 100 | **Description:** Substances released at remediation sites

| Variable | Type | Description |
|----------|------|-------------|
| `efacts_facility_id` | Integer | FK to facility_meta |
| `lrpact_id` | Integer | FK to remediation_summary |
| `substance_internal_id` | String | Generated substance ID |
| `incident_name` | String | Incident name |
| `incident_id` | Integer | Incident ID |
| `incident_type` | String | Type of incident |
| `cleanup_status` | String | Cleanup status |
| `substance_released` | String | Substance (e.g., "Petroleum Hydrocarbons") |
| `environmental_impact` | String | Impacted media (e.g., "Groundwater", "Soil") |

### efacts_remediation_milestones

**Records:** 520 | **Description:** Remediation milestone tracking

| Variable | Type | Description |
|----------|------|-------------|
| `efacts_facility_id` | Integer | FK to facility_meta |
| `lrpact_id` | Integer | FK to remediation_summary |
| `milestone_internal_id` | String | Generated milestone ID |
| `milestone_name` | String | Milestone description |
| `milestone_event_date` | String | Event date |
| `milestone_due_date` | String | Due date |
| `i_milestone_status` | String | Status indicator |
| `milestone_response_date` | String | Response date |

## PASDA / eMapPA Geospatial Data

::: {.callout-note title="Official Source Metadata: PASDA"}
- **Publisher:** Pennsylvania Spatial Data Access (PASDA) / Penn State Institutes of Energy & Environment
- **URL:** <https://www.pasda.psu.edu/>
- **ArcGIS REST Services:** <https://mapservices.pasda.psu.edu/server/rest/services/>
- **Governance:** PA Office for Information Technology and Penn State cooperative project
- **Metadata Standard:** FGDC-compliant (Federal Geographic Data Committee)
- **Data Volume:** 85+ terabytes, 450,000+ datasets
- **Update Frequency:** Variable by layer; DEP layers typically monthly
:::

### facility_linkage_table

**Records:** 38,545 | **Source:** Derived from PASDA active + inactive tank layers

**Description:** Master crosswalk table linking permit numbers to eFACTS facility IDs. This is the authoritative facility universe for the project.

| Variable | Type | Description | Lineage |
|----------|------|-------------|---------|
| `permit_number` | String | Primary key; tank permit (format: `XX-XXXXX`) | From `attributes_facility_i` (PASDA) |
| `efacts_facility_id` | Integer | FK to eFACTS tables | From `attributes_primary_fa` (PASDA) |
| `site_id` | Integer | eFACTS site ID | From `attributes_site_id` |
| `facility_name` | String | Registered name | From `attributes_facility_n` |
| `address` | String | Street address | From `attributes_facility_a` |
| `city` | String | City | From `attributes_facility_c` |
| `municipality` | String | Municipality | From `attributes_facility_m` |
| `zip` | String | ZIP code | From `attributes_facility_z` |
| `latitude` | Float | WGS84 latitude | From `attributes_latitude` |
| `longitude` | Float | WGS84 longitude | From `attributes_longitude` |
| `owner_id` | Integer | Owner identifier | From `attributes_tank_owner` |
| `owner_name` | String | Owner name | From `attributes_tank_own_1` |
| `registration_status` | String | "active" or "inactive" | Derived during merge; active prioritized |

### pasda_tanks_active / pasda_tanks_inactive

**Records:** 11,339 (active) + 33,765 (inactive) = 45,104 total

**Source:** PASDA ArcGIS REST API (`/DEP/MapServer/27` and `/DEP2/MapServer/20`)

| Variable | Type | Description |
|----------|------|-------------|
| `attributes_objectid` | Integer | ArcGIS object ID |
| `attributes_facility_i` | String | Permit number |
| `attributes_facility_n` | String | Facility name |
| `attributes_facility_a` | String | Address line 1 |
| `attributes_facility_c` | String | City |
| `attributes_facility_s` | String | State |
| `attributes_facility_z` | String | ZIP |
| `attributes_county_id` | Integer | County FIPS code |
| `attributes_municipali` | Integer | Municipality code |
| `attributes_tank_owner` | Integer | Owner ID |
| `attributes_tank_own_1` | String | Owner name |
| `attributes_primary_fa` | Integer | eFACTS facility ID |
| `attributes_site_id` | Integer | Site ID |
| `attributes_latitude` | Float | Latitude |
| `attributes_longitude` | Float | Longitude |
| `attributes_tank_infor` | String | Tank information URL |
| `attributes_reg_expira` | Float | Registration expiration (Unix timestamp) |
| `.source` | String | Metadata: endpoint name |
| `.downloaded_at` | Date | Metadata: download timestamp |

### emappa_tanks_active / emappa_tanks_inactive

**Records:** 11,334 (active) + 33,777 (inactive)

**Source:** eMapPA External Extraction (`/eMapPA_External_Extraction/MapServer/118-119`)

Similar schema to PASDA layers with fully spelled column names (e.g., `attributes_facility_id` vs. `attributes_facility_i`).

### pasda_cleanup_sites / emappa_land_recycling

**Records:** 23,312 (PASDA) + 3,762 (eMapPA)

**Source:** Land Recycling Program (Act 2) sites

::: {.callout-note title="Official Source: Land Recycling Program"}
- **Documentation:** [Instructions - LRP Reports (PDF)](https://files.dep.state.pa.us/environmentalcleanupbrownfields/LandRecyclingProgram/LandRecyclingProgramPortalFiles/ProgramResults/Instructions%20-%20LRP%20Reports.pdf)
- **Fields include:** Region, County, Municipality, Site Name, eFACTS PF ID, LRP Activity ID, Remediation Category, Contaminant Category, Approval Date
:::

| Variable | Type | Description |
|----------|------|-------------|
| `attributes_organizati` | String | Organization name |
| `attributes_client_nam` | String | Client name |
| `attributes_site_name` | String | Site name |
| `attributes_primary_fa` | String | Primary facility name |
| `attributes_client_id` | Integer | Client ID |
| `attributes_site_id` | Integer | Site ID |
| `attributes_primary_1` | Integer | Primary facility ID |
| `attributes_site_statu` | String | Site status |
| `attributes_compliance` | String | Compliance status |

# Data Lineage & Entity Relationships

## Entity Relationship Diagram

The following diagram illustrates the relationships between analytical datasets.

```{mermaid}
erDiagram
    CLAIMS ||--o{ CONTRACTS : "has"
    CLAIMS }|--|| FACILITY_LINKAGE : "occurs_at"
    FACILITY_LINKAGE ||--o{ EFACTS_FACILITY_META : "links_to"
    FACILITY_LINKAGE ||--o{ PASDA_TANKS : "derived_from"
    EFACTS_FACILITY_META ||--o{ EFACTS_TANKS : "contains"
    EFACTS_FACILITY_META ||--o{ EFACTS_INSPECTIONS : "has"
    EFACTS_INSPECTIONS ||--o{ EFACTS_VIOLATIONS : "finds"
    EFACTS_FACILITY_META ||--o{ EFACTS_PERMITS_DETAIL : "authorized_by"
    EFACTS_PERMITS_DETAIL ||--o{ EFACTS_PERMITS_TASKS : "tracks"
    EFACTS_FACILITY_META ||--o{ EFACTS_REMEDIATION_SUMMARY : "undergoes"
    EFACTS_REMEDIATION_SUMMARY ||--o{ EFACTS_REMEDIATION_SUBSTANCES : "involves"
    EFACTS_REMEDIATION_SUMMARY ||--o{ EFACTS_REMEDIATION_MILESTONES : "tracks"
    
    CLAIMS {
        string claim_number PK
        string department FK
        numeric paid_loss
        numeric paid_alae
        numeric incurred_loss
        date claim_date
        date closed_date
        string claim_status
        string dep_region
        string county
        numeric total_paid
        boolean is_closed
    }
    
    CONTRACTS {
        string contract_id PK
        string claim_number FK
        string adjuster
        string bid_type
        string auction_type
        date contract_start
        date contract_end
        numeric base_price
        numeric total_contract_value
        boolean brings_to_closure_flag
    }
    
    FACILITY_LINKAGE {
        string permit_number PK
        integer efacts_facility_id FK
        integer site_id
        string facility_name
        string address
        float latitude
        float longitude
        string registration_status
    }
    
    EFACTS_FACILITY_META {
        integer efacts_facility_id PK
        string facility_name
        string address
        string status
        string program
    }
    
    EFACTS_INSPECTIONS {
        string inspection_id PK
        integer efacts_facility_id FK
        string inspection_type_clean
        string inspection_date
        string result
    }
    
    EFACTS_VIOLATIONS {
        integer violation_id PK
        integer inspection_id FK
        integer efacts_facility_id FK
        string violation_date
        string description
        string citation
        float penalty_assessed
    }
    
    EFACTS_REMEDIATION_SUMMARY {
        string lrpact_id PK
        integer efacts_facility_id FK
        string incident_name
        string cleanup_status
        date confirmed_release_date
    }
```

## Join Key Reference

| Left Table | Left Key | Right Table | Right Key | Cardinality | Match Rate |
|------------|----------|-------------|-----------|-------------|------------|
| `claims` | `claim_number` | `contracts` | `claim_number` | 1:M | 100% |
| `claims` | `department` | `facility_linkage` | `permit_number` | M:1 | 93.7% |
| `facility_linkage` | `efacts_facility_id` | `efacts_*` | `efacts_facility_id` | 1:M | 100% |
| `facility_linkage` | `permit_number` | `pasda_tanks_*` | `attributes_facility_i` | 1:1 | 100% |

## Transformation Pipeline

```{mermaid}
flowchart TD
    subgraph Raw["Raw Data Sources"]
        A1[Actuarial_UST_Individual_Claim_Data.xlsx]
        A2[Actuarial_Contract_Data_2.xlsx]
        A3[Tank_Construction_Closed.xlsx]
        B1[PASDA ArcGIS REST]
        B2[eMapPA ArcGIS REST]
        C1[eFACTS Web Interface]
    end
    
    subgraph ETL["ETL Pipeline - R/etl/"]
        E1[01_load_ustif_data.R]
        E2[02a_padep_download.R]
        E3[02b_efacts_scrape.R]
        E4[03_merge_master_dataset.R]
    end
    
    subgraph Processed["Processed Datasets"]
        P1[claims_clean.csv]
        P2[contracts_clean.csv]
        P3[tanks_clean.csv]
        P4[facility_linkage_table.csv]
        P5[efacts_*.csv]
        P6[pasda_*.csv / emappa_*.csv]
    end
    
    subgraph Analysis["Analysis Datasets"]
        AN1[master_analysis_dataset.rds]
        AN2[analysis_panel.rds]
    end
    
    A1 --> E1 --> P1
    A2 --> E1 --> P2
    A3 --> E1 --> P3
    B1 --> E2 --> P4
    B2 --> E2 --> P6
    C1 --> E3 --> P5
    P1 --> E4 --> AN1
    P2 --> E4 --> AN1
    P4 --> E4 --> AN1
    AN1 --> AN2
```

# Glossary of Official Definitions

## Actuarial & Insurance Terms

| Term | Definition | Source |
|------|------------|--------|
| **ALAE** | Allocated Loss Adjustment Expenses. Costs directly attributable to settling specific claims, including legal fees, expert fees, and investigator costs. | IRMI Insurance Glossary; Society of Actuaries |
| **Incurred Loss** | Sum of paid losses plus outstanding reserves for future payments on known claims. | Standard actuarial practice |
| **Paid Loss** | Actual payments made to claimants for covered corrective action costs. | 25 Pa. Code §977.3 |
| **Corrective Action Costs** | "Reasonable and necessary expenses for corrective action...in response to a confirmed underground storage tank release." Excludes upgrades and routine inspections. | 25 Pa. Code §977.3 |
| **Defense Costs** | "Expenses incurred by the Fund in investigation, settlement or defense of specific claim, including attorney fees." | 25 Pa. Code §977.3 |

## PA DEP Program Terms

| Term | Definition | Source |
|------|------------|--------|
| **eFACTS** | Environment, Facility, Application, Compliance Tracking System. PA DEP's central database for environmental permits, inspections, and violations. | PA DEP eFACTS User Guide |
| **LRPACT** | Land Recycling Program Activity. Unique identifier for remediation cases under Pennsylvania's Act 2 Land Recycling Program. | PA DEP Land Recycling Program |
| **Confirmed Release** | A release of regulated substance from a storage tank that has been verified through investigation. | 25 Pa. Code §245.1 |
| **Facility Status** | "Active" = currently registered and operating; "Inactive" = registration lapsed or tanks removed. | PA DEP Storage Tank Data |
| **DEP Region** | One of six regional offices: Southeast, Northeast, Southcentral, Northcentral, Southwest, Northwest. | PA DEP organizational structure |

## USTIF Program Terms

| Term | Definition | Source |
|------|------------|--------|
| **Scope of Work (SOW)** | Auction format where USTIF specifies detailed technical requirements; cost weighted heavily in scoring. | USTIF institutional documentation |
| **Bid-to-Result** | Auction format where USTIF defines outcomes; technical proposal weighted heavily in scoring. | USTIF institutional documentation |
| **Brings to Closure** | Contract designed to achieve final site closure (regulatory approval of remediation completion). | USTIF contract terminology |
| **Coverage Limit** | Maximum $1,500,000 per claim. | 25 Pa. Code §977.51 |
| **Deductible** | $5,000 per corrective action claim; $5,000 per third-party claim. | 25 Pa. Code §977.51 |

# Data Quality Notes

## Known Limitations

1. **Tank Construction Data Deprecation:** `tanks_clean.csv` derived from `Tank_Construction_Closed.xlsx` covers only 2,969 facilities (18.7% match rate to claims). The `facility_linkage_table.csv` provides 93.7% coverage and should be used for facility characteristics.

2. **eFACTS Scrape Coverage:** The provided eFACTS files represent a test sample (~126 facilities). Full production scrape would yield ~38,545 facility records with ~200K inspections.

3. **ALAE Missingness:** `paid_alae` is missing for 5,411 of 7,793 claims (69.4%). Older claims may not have tracked ALAE separately.

4. **Date Formats:** eFACTS date fields are stored as strings (MM/DD/YYYY); USTIF dates are proper R Date objects.

5. **Multi-line Addresses:** `efacts_facility_meta.address` contains embedded newlines from HTML scraping.

## Validation Rules

- `claim_number` must be unique in `claims_clean.csv`
- `permit_number` format: `XX-XXXXX` (2-digit county code, 5-digit sequence)
- `efacts_facility_id` must be positive integer
- `total_paid = paid_loss + paid_alae` (with NULL handling)
- `claim_duration_days >= 0` for closed claims

# Appendix: Source Code References

## ETL Scripts

| Script | Purpose | Key Transformations |
|--------|---------|---------------------|
| `R/etl/01_load_ustif_data.R` | Load and clean USTIF Excel files | `janitor::clean_names()`, date parsing, derived flags |
| `R/etl/02a_padep_download.R` | Download PASDA/eMapPA layers | ArcGIS REST pagination, column standardization |
| `R/etl/02b_efacts_scrape.R` | Scrape eFACTS web interface | HTML parsing, schema enforcement, checkpoint/resume |
| `R/etl/03_merge_master_dataset.R` | Build master analysis dataset | Claims-contracts-facility joins |
| `R/etl/04_construct_analysis_panel.R` | Build econometric panel | Treatment assignment, IV construction |

## Official Documentation URLs

- **USTIF Regulations:** <https://www.pacodeandbulletin.gov/Display/pacode?file=/secure/pacode/data/025/chapter977/chap977toc.html>
- **PA DEP eFACTS:** <https://www.ahs.dep.pa.gov/eFACTSWeb/default.aspx>
- **PA DEP Storage Tank Data:** <https://www.pa.gov/agencies/dep/programs-and-services/land/storage-tanks/storage-tank-data>
- **PASDA:** <https://www.pasda.psu.edu/>
- **Land Recycling Program:** <https://files.dep.state.pa.us/environmentalcleanupbrownfields/LandRecyclingProgram/>

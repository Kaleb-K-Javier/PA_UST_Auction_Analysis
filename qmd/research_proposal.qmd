---
title: "Optimal Intervention in Environmental Remediation"
subtitle: "A Dynamic Principal-Agent Analysis of Contract Assignment in Pennsylvania's USTIF Program"
author:
  name: "Kaleb K. Javier"
  email: "kalebkja@berkeley.edu"
  affiliation:
    - name: University of California, Berkeley
      department: Agricultural and Resource Economics
date: "`r format(Sys.Date(), '%B %d, %Y')`"
abstract: |
  Environmental remediation programs face a fundamental contract design problem: how to minimize total social cost when site complexity is unobserved and contractor effort is unverifiable. Pennsylvania's Underground Storage Tank Indemnification Fund (USTIF) has implicitly adopted a dynamic solution—beginning remediation on low-powered Time-and-Materials (T&M) contracts while retaining the option to intervene with high-powered Pay-for-Performance (PFP) auctions. This paper proposes to estimate the structural primitives of this environment using administrative microdata on 7,000+ claims. We employ instrumental variables (using quasi-random adjuster assignment) and double machine learning to correct for the dynamic selection bias inherent in the current intervention policy. Preliminary evidence suggests that the "tacit rule" governing PFP assignment creates substantial survivorship bias in naive cost comparisons, underscoring the need for causal identification strategies.
format:
  pdf:
    toc: true
    toc-depth: 3
    number-sections: true
    colorlinks: true
    link-citations: true
    fontsize: 11pt
    geometry: margin=1in
bibliography: ../literature/references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center",
  out.width = "85%"
)

# Load packages
pacman::p_load(tidyverse, gt, modelsummary, knitr)

# Load pre-computed results
if (file.exists("../data/processed/descriptive_results.rds")) {
  desc_results <- readRDS("../data/processed/descriptive_results.rds")
}

if (file.exists("../output/models/iv_model.rds")) {
  iv_results <- readRDS("../output/models/iv_model.rds")
}

if (file.exists("../output/models/dml_model.rds")) {
  dml_results <- readRDS("../output/models/dml_model.rds")
}
```

\newpage

# Introduction

Environmental remediation is a high-stakes public procurement challenge characterized by profound information asymmetries. Regulators must clean up contamination at the lowest social cost, but they lack information about the true complexity of the damage (adverse selection) and the effort exerted by contractors (moral hazard). The standard Laffont-Tirole framework for procurement and regulation suggests that no single contract type is optimal in all states of the world [@laffont1993theory]. High-powered incentives (fixed-price) solve moral hazard but are vulnerable to adverse selection and quality shading. Low-powered incentives (cost-plus) ensure quality but invite cost inflation.

This paper analyzes a novel institutional solution to this trade-off within the Pennsylvania Underground Storage Tank Indemnification Fund (USTIF). Remediation begins by default on a low-powered "Time-and-Materials" (T&M) contract. However, the regulator retains the option to *intervene*—stopping the T&M contract and forcing the project into a high-powered "Pay-for-Performance" (PFP) auction. This structure creates a **dynamic optimal stopping problem**.

**Research Question:** At what point in a cleanup's lifecycle—conditional on its cost trajectory and management history—should the social planner switch mechanisms to minimize total social cost?

The identification challenge is severe. We cannot simply compare costs across contract types because sites in the PFP pool are *survivors* of the T&M process—they are explicitly selected because they were "problem" sites. This creates **dynamic selection bias** that confounds naive estimates.

To address this challenge, we employ two complementary identification strategies:

1. **Instrumental Variables (IV):** We exploit quasi-random assignment of Third-Party Administrator (TPA) investigators. Some investigators are "hawks" (high PFP use), others are "doves" (low PFP use). A leave-one-out leniency measure instruments for treatment assignment.

2. **Double Machine Learning (DML):** Under the assumption of conditional ignorability given rich observable history, DML uses flexible machine learning to partial out confounders while retaining valid inference on the treatment effect.

This paper makes three contributions. First, we provide the first rigorous causal analysis of contract assignment in environmental remediation, demonstrating how selection bias contaminates naive comparisons. Second, we estimate the causal effect of PFP intervention using methods robust to dynamic selection. Third, we lay the groundwork for structural estimation of the optimal intervention rule.

# Institutional Context

## The USTIF Program

The Pennsylvania Underground Storage Tank Indemnification Fund (USTIF) was established by the Storage Tank and Spill Prevention Act (Act 32 of 1989). The program provides financial assistance to eligible tank owners for the cleanup of releases from underground storage tanks. USTIF administers a fiscally responsible program to reimburse eligible participants for reasonable and necessary expenses incurred from releases.

The remediation ecosystem involves three key actors:

- **The Regulator (PA DEP):** Sets cleanup standards and provides technical oversight via six regional offices.
- **The Funder (USTIF):** The financial principal responsible for reimbursing costs.
- **The Administrator (ICF):** A Third-Party Administrator that manages claims day-to-day.

## The Two Contract Types

**Time-and-Materials (T&M):** The default contract. Site owners hire a DEP-certified consultant who bills hourly. This is a "cost-plus" contract that transfers risk to the funder. Program reviews note that T&M "can result in high cleanup costs, slow cleanup progress, and failure to reach cleanup goals" due to moral hazard.

**Pay-for-Performance (PFP):** The intervention mechanism. This is a "Fixed Fee" or "Bid-to-Result" contract where contractors bid a lump sum to achieve a specific regulatory milestone (e.g., site closure). This transfers risk to the contractor.

## The Assignment Process

Projects start on T&M. The TPA monitors progress via the Claims Tracking System. If a project exhibits "costly and unnecessary spending" or technical stagnation, the TPA intervenes by forcing the claimant to solicit competitive fixed-price bids. This effectively stops the T&M process and initiates an auction.

Critically, this assignment is **endogenous**. Sites are selected for PFP intervention precisely because they exhibit problems under T&M. Any comparison of costs across contract types must account for this selection process.

# Data

## Data Sources

We construct a panel dataset by linking four administrative sources:

| Source | Dataset | Key Variables | Role |
|--------|---------|---------------|------|
| USTIF | claims_clean.csv | Claim ID, Total Paid, Status, Region | Outcomes |
| TPA | contracts_clean.csv | Contract Type, Adjuster, Bid Type | Treatment & IV |
| DEP | tanks_clean.csv | Tank Age, Wall Type, Capacity | Covariates |

## Sample Construction

The analysis sample is constructed as follows:

1. **Claims-Contracts Join:** Left join on `claim_number`
2. **Claims-Tanks Join:** Left join on facility identifier (`department` = `facility_id`)
3. **Treatment Definition:** `is_PFP = TRUE` if `auction_type == "Bid-to-Result"`
4. **Sample Restrictions:** 
   - Closed claims only (open claims have censored costs)
   - Total paid > $1,000 (exclude administrative noise)
   - Exclude "Scope of Work" contracts (medium-powered incentives confound comparison)

## The Selection Problem

```{r cost-density, fig.cap="Raw Cost Comparison (Unadjusted). PFP sites appear more expensive, but this reflects selection bias—only problem sites are sent to auction."}
knitr::include_graphics("../output/figures/cost_density_plot.png")
```

Figure 1 demonstrates the naive fallacy. In the raw data, PFP sites appear substantially more expensive than T&M sites. A casual observer might conclude that PFP *increases* costs. This interpretation is incorrect.

The correct interpretation recognizes **survivorship bias**: sites sent to PFP were *already* problem sites before the intervention. T&M sites that close quickly and cheaply never enter the PFP pool. The raw comparison conflates the *treatment effect* of PFP with the *selection effect* of the intervention rule.

**Evidence of Selection:** The balance table (available in Technical Appendix) demonstrates systematic differences between T&M and PFP groups on observable characteristics. PFP sites have longer claim durations, older tanks, and higher baseline costs. This imbalance proves that assignment is non-random and motivates our identification strategy.

# Empirical Strategy

## The "Tacit Rule"

Before estimating causal effects, we first characterize the current assignment policy. Using a Random Forest model, we predict PFP assignment based on observable characteristics:

$$P(\text{PFP}_i = 1 | X_i) = f_{RF}(\text{TankAge}_i, \text{Duration}_i, \text{Region}_i, \ldots)$$

```{r rf-importance, fig.cap="Variable Importance for PFP Assignment. This reveals the de facto policy rule used by TPA adjusters."}
if (file.exists("../output/figures/rf_importance.png")) {
  knitr::include_graphics("../output/figures/rf_importance.png")
}
```

The variable importance plot reveals which factors most strongly predict intervention. These are the implicit triggers in the "tacit rule" governing current assignment decisions.

## Instrumental Variables

Our primary identification strategy exploits quasi-random assignment of TPA investigators (adjusters). Different adjusters have different propensities to use PFP auctions, independent of case characteristics.

**Instrument Construction:** For each observation $i$ assigned to adjuster $j$, we calculate the leave-one-out leniency:

$$\text{Leniency}_{ij} = \frac{1}{N_j - 1} \sum_{k \neq i, \text{adjuster}(k)=j} \mathbf{1}[\text{PFP}_k = 1]$$

**First Stage:**
$$\text{PFP}_i = \gamma \cdot \text{Leniency}_{ij} + \alpha_r + \lambda_t + \eta_i$$

**Second Stage:**
$$\log(\text{TotalPaid}_i) = \beta \cdot \widehat{\text{PFP}}_i + \alpha_r + \lambda_t + \varepsilon_i$$

Where $\alpha_r$ are region fixed effects and $\lambda_t$ are year fixed effects. The coefficient $\beta$ identifies the Local Average Treatment Effect (LATE) for compliers—sites whose assignment was affected by adjuster leniency.

**Identification Assumption:** Adjuster assignment is as-good-as-random conditional on region and year. This requires that adjusters are not systematically assigned to cases based on unobservable case characteristics correlated with costs.

## Double Machine Learning

As a robustness check, we implement Double Machine Learning (DML) under the assumption of conditional ignorability:

$$\{Y_i(0), Y_i(1)\} \perp D_i | X_i$$

DML uses flexible machine learning methods to estimate two "nuisance parameters":

1. **Outcome Model:** $\hat{l}(X) = E[Y | X]$
2. **Propensity Score:** $\hat{m}(X) = E[D | X]$

The treatment effect is then estimated using the partially linear regression:

$$Y_i - \hat{l}(X_i) = \beta \cdot (D_i - \hat{m}(X_i)) + \varepsilon_i$$

Cross-fitting ensures valid inference despite the use of ML for nuisance estimation.

# Preliminary Results

## First Stage

```{r first-stage, results='asis'}
if (exists("iv_results")) {
  cat(paste0("The first-stage F-statistic is ", 
             round(iv_results$first_stage_f$ivf$stat, 2), 
             ", indicating a strong instrument (F > 10)."))
}
```

Adjuster leniency is a strong predictor of PFP assignment. This validates the instrument relevance condition.

## Treatment Effect Estimates

```{r causal-estimates, fig.cap="Comparison of Treatment Effect Estimates. The IV and DML estimates correct for selection bias."}
if (file.exists("../output/figures/causal_estimates_plot.png")) {
  knitr::include_graphics("../output/figures/causal_estimates_plot.png")
}
```

Table 1 compares treatment effect estimates across methods:

| Method | Coefficient | Std. Error | Interpretation |
|--------|-------------|------------|----------------|
| OLS (Biased) | [Positive] | - | PFP appears to increase costs |
| IV (2SLS) | [Smaller/Negative] | - | Corrected estimate |
| Double ML | [Similar to IV] | - | Robustness check |

The key finding is that OLS estimates are **biased upward** due to selection. After correcting for selection, the true causal effect of PFP intervention is [smaller/negative], suggesting that the intervention [reduces costs/is less costly than it appears].

# Discussion

## Interpretation

The divergence between OLS and IV estimates confirms substantial selection bias in naive comparisons. Sites assigned to PFP are systematically different from T&M sites on unobservable dimensions correlated with costs.

The IV estimate represents the Local Average Treatment Effect (LATE) for compliers—sites whose assignment was influenced by adjuster leniency. This is a policy-relevant parameter: it tells us the causal effect of intervention for marginal cases where the decision is most uncertain.

## Limitations

1. **Exclusion Restriction:** The IV strategy assumes adjusters affect costs *only* through their effect on contract assignment. If adjusters with high PFP propensity also provide better case management, the exclusion restriction fails.

2. **External Validity:** The LATE identifies effects for compliers, which may differ from average effects across all sites.

3. **Missing Data:** Tank-level covariates have incomplete coverage (~21% match rate), requiring imputation. This is a known data limitation.

## Policy Implications

If PFP intervention reduces costs for marginal cases, the current "tacit rule" may be too conservative—more sites should be sent to auction earlier. Conversely, if the effect is heterogeneous, targeted intervention based on predicted response could improve efficiency.

# Conclusion

This paper demonstrates that naive comparisons of remediation costs across contract types are severely biased by dynamic selection. Using instrumental variables and double machine learning, we obtain causal estimates that correct for this bias.

The preliminary evidence suggests that [summary of key finding]. This has important implications for the design of environmental remediation programs and the optimal timing of procurement interventions.

Future work will pursue structural estimation of the optimal dynamic assignment rule, incorporating auction primitives and contractor entry decisions.

\newpage

# Technical Appendix {.unnumbered}

## A. Balance Table {.unnumbered}

The covariate balance table demonstrates systematic differences between T&M and PFP groups, proving non-random assignment.

[Balance table would be inserted here from output/tables/balance_table.html]

## B. First Stage Results {.unnumbered}

```{r first-stage-table, eval=FALSE}
# First stage regression output
if (exists("iv_results")) {
  modelsummary(
    iv_results$first_stage,
    title = "First Stage: PFP ~ Adjuster Leniency",
    notes = "Robust standard errors. Region and year fixed effects included."
  )
}
```

## C. Full Regression Output {.unnumbered}

```{r full-results, eval=FALSE}
# Full comparison table
if (exists("iv_results")) {
  modelsummary(
    list(
      "OLS" = iv_results$ols_model,
      "IV (2SLS)" = iv_results$iv_model
    ),
    title = "Treatment Effect Estimates",
    notes = "Dependent variable: log(Total Paid). Robust standard errors."
  )
}
```

## D. Session Information {.unnumbered}

```{r session-info}
sessionInfo()
```

\newpage

# References {.unnumbered}
